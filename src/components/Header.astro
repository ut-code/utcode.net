---
import { Icon } from "astro-icon/components";
import Logo from "./Logo.astro";
import { Focus } from "../schema.ts";
import { ClientRouter } from "astro:transitions";

const links = [
  { title: "プロジェクト", to: "/projects", focus: Focus.projects },
  { title: "記事", to: "/articles", focus: Focus.articles },
  { title: "メンバー", to: "/members", focus: Focus.members },
  { title: "参加", to: "/join", focus: Focus.join },
  { title: "お問い合わせ", to: "/contact", focus: Focus.contact },
];

interface Props {
  focus: Focus;
}
const { focus } = Astro.props;
---

<ClientRouter />
<header class="sticky">
  {
    /* <div class="flex gap-4 justify-center items-center px-1 py-3 md:py-1 bg-green-400">
        <span>
          <span class="hidden sm:inline">
            「AI で日常を便利に」をテーマとした
          </span>
          ハッカソンを開催します
        </span>
        <a
          to="/articles/coeteco-hack-2-announcement/"
          class="inline-flex items-center flex-shrink-0 gap-0.5 hover:underline"
        >
          詳細はこちら
          <FiArrowRight />
        </a>
      </div> */
  }
  <div class="flex h-16">
    <a href="/" class="flex items-center px-4">
      <Logo class="w-36" variant="default" />
    </a>
    <div aria-hidden class="flex-grow"></div>
    <ul class="hidden md:flex">
      {
        links.map((link) => (
          <li>
            <a
              href={link.to}
              class:list={[
                "navigation-bar flex h-full items-center px-6",
                focus === link.focus && "current",
              ]}
            >
              {link.title}
            </a>
          </li>
        ))
      }
    </ul>
    <button
      type="button"
      class="flex h-full w-16 items-center justify-center hover:bg-gray-100 md:hidden"
      popovertarget="navigation_panel"
      popovertargetaction="toggle"
    >
      <Icon name="feather:menu" class="h-6 w-6 text-gray-600" />
    </button>
  </div>
  <div
    id="navigation_panel"
    popover
    class="absolute top-16 w-full transition-opacity duration-300"
  >
    <ul class="">
      {
        links.map((link) => (
          <li>
            <a
              href={link.to}
              class="block px-4 py-2 transition-all duration-300 hover:bg-gray-100"
            >
              {link.title}
            </a>
          </li>
        ))
      }
    </ul>
  </div>
</header>

<style>
  /* https://stackoverflow.com/questions/77042256/css-transition-animation-not-working-for-popover-attribute */
  [popover] {
    opacity: 0;
    &:popover-open {
      opacity: 1;
      @starting-style {
        opacity: 0;
      }
    }
    transition:
      opacity 0.3s,
      display 0.3s;
    transition-behavior: allow-discrete;
  }

  .navigation-bar {
    background: linear-gradient(currentColor 0 0) bottom left/
      var(--underline-width, 0%) 0.1em no-repeat;
    text-decoration: none;
    transition: background-size 0.5s ease-out;
  }
  .navigation-bar.current {
    background: linear-gradient(lawngreen 0 0) bottom left/
      var(--underline-width, 0%) 0.1em no-repeat;
  }
  .navigation-bar:hover {
    --underline-width: 100%;
    @starting-style {
      --underline-width: 0%;
    }
  }
</style>
